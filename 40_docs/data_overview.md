Initially, our analysis involved working with three distinct datasets. The first dataset, sourced from the Washington Post, encompasses comprehensive details about opioid shipments across various counties, states, and years in the United States. This dataset is notably extensive, with a file size of around 100 GB, presented in a large TSV (Tab-Separated Values) format. The second dataset, obtained from the US Vitality Statistics Dataset, consists of information on diverse types of deaths occurring over multiple years and states in the US. This dataset is structured as 12 separate CSV files, each corresponding to a specific year. The third dataset, sourced from the US Census Bureau, provides insights into populations across different states and counties in the US.

Due to the substantial size of the opioid shipments dataset, a one-time parsing and cleaning process proved impractical. Consequently, we leveraged the Dask library to efficiently parse the data into 207 distinct Parquet files. Parquet was chosen as the storage format for its columnar structure, which enhances performance and storage efficiency. In the analysis, we opted not to normalize the opioid shipment data by population, as normalization yielded skewed results during pre-post and Difference-in-Differences (DiD) analyses. The selected variables for further analysis include county, state, year, and the total gross opioid shipments in grams for each county in each state across different years.

The "Underlying Cause of Death" datasets, spanning from 2003 to 2015, were structured as 12 separate files, each corresponding to a specific year. Our approach involved systematically iterating through these 12 datasets, extracting information related to drug overdose deaths and drug-related suicides. These subsets were consolidated into a comprehensive CSV file, encompassing overdose deaths for all counties from 2003 to 2015. Subsequently, this dataset underwent a merger with the population dataset, utilizing the unique combination of state and county (State-County). The choice of this unique combination is crucial, ensuring precision in the dataset linkage, especially considering the potential presence of certain counties in multiple states.

The combined dataset resulting from the merger of opioid-related deaths and population data exhibited notable gaps due to instances where certain counties reported zero opioid-related deaths in a given year. To address these missing values judiciously, a death rate was computed for each county, calculated as the total number of deaths divided by the total population. Subsequently, for counties with zero reported deaths, the missing values were imputed by multiplying the total population by the corresponding death rate. This approach ensured a nuanced estimation of opioid-related deaths in counties with sparse or no recorded incidents. Additionally, a threshold of 10 was enforced to cap the estimated number of deaths, maintaining a realistic range for the imputed values.

In the pursuit of discerning the impact of policy implementation on opioid shipments and overdose deaths in Texas, Florida, and Washington, our analysis designated these states as treatment groups. The crucial task of identifying suitable reference states, pivotal for conducting a robust Difference-in-Differences (DiD) analysis, involved an in-depth exploration of the trends exhibited by each treatment state before and after policy implementation. This exploration extended to studying the geographical and historical context of these states, including their association with opioids. By meticulously comparing the trends of potential reference states with the treatment states, we sought states that mirrored the pre-policy trends and represented a counterfactual scenario for the treatment states. This strategic approach facilitated the construction of reliable counterfactuals, crucial for causal inference in the DiD analysis, enhancing the accuracy of our findings.

To ensure consistency and precision in our analyses, we maintained the unit of observation at the county level for both opioid shipment and overdose death analyses. Although we aggregated data to the state level for certain aspects, our primary focus remained at the county level, ensuring a more detailed and nuanced examination of the impact of policy changes on specific communities.

